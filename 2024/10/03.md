# 取り組んだ課題

- Webセキュリティ

# わかったこと

- Reactを使用することで、仮想DOMからDOMをレンダリングする際にXSSができなくなるようにエスケープ処理が実行されるが、propsから渡ってきた値などを表示する場合とかはエスケープ処理が実行されない場合があり、XSSの脆弱性が存在する
    - [React における XSS](https://zenn.dev/yuuhu04/books/xss-anti-pattern-of-react-and-vue/viewer/xss-over-react)

- フロントエンド側 (Next) では、idトークンとアクセストークンを直接保存するのではなく、これら二つのトークンをセッションに保存してセッションidをcookieに保存する？
- 上記の場合、セッションにトークンを保存する処理は、フロント側で行うのでしょうか？また、その責務はNextAuthなどが担うのでしょうか？
    - NextAuthの`callbacks`の設定で、トークンをセッションに保存するロジックを定義できる
    - デフォルトでは、NextAuthがトークンを暗号化してCookieに保存する
- JWTの検証 (署名チェック) をRails側 (gem jwt) で行うとしたら、フロント側のNextAuthは必要か？
- リフレッシュトークンの保管方法の具体例とベストプラクティス
    - リフレッシュトークンに関しては、バックエンド側でredisなどと用いて安全に管理する
    - そもそも`redis`とは？
        - 高速で柔軟性の高いキーバリューストア
        - NoSQLのキーバリュー型の一つで、インメモリ型 (メモリ上にデータを保存)
        - 通常のSQLは、ハードディスクなどにデータを保存
- リフレッシュトークンの実装するメリット・しないデメリット
    - メリット
        - 頻繁な再ログインがなくなる (ユーザー体験向上)
        - アクセストークンの有効期限を短く設定できる (セキュリティ強化)
        - ユーザーの継続的な認証状態の維持 (長期的なセッション管理)
    - デフォルトの有効期限は30日 (長くても3ヶ月?)
    - デメリット
- cookieにトークンを直接保存せずに暗号化して保存する場合と、上記のセッションに保存してからセッションidを保存する実装方法の是非について
    - Cookieに暗号化して保存する、もしくはフロント側で各種トークンをセッションに保存して、セッションIDをCookieに保存する方法などが良い

# 次やること

- React インプット
- Webセキュリティ 記事作成

# 感じたこと

- セキュリティの理解は、実際にやられサイトなどを触ってみてじゃないと理解が進まないなと感じた..

# 学習時間

1005h