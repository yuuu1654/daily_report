# 取り組んだ課題

- React TODO
    - リファクタ
        - todo関連の操作をカスタムフック化
- Webセキュリティ

# わかったこと

- Chakra UIのInputタグも通常のInputタグも`autoFocus={true}` が使えた

- Cognitoを用いた認証では、idトークン = jwtと認識して問題ないか？
- その場合、アクセストークンはjwtとは限らないのか？
- また、リフレッシュトークンもjwt形式か？
    - Cognitoの場合は、アクセストークンもjwt形式になる
    - リフレッシュトークンはjwt形式ではなく、単なる文字列
        - リフレッシュトークンは、長期間有効であるため、内容を変更できないjwt形式は適していない
- `リフレッシュトークン`はCookieに持たせないのか？
    - リフレッシュトークンは、バックエンド側で安全に保管される (redisなどに保存)
    - Amplifyの場合は、cognitoが3種のトークンを発行したらlocalStorageに3つとも保存するそう…
- リフレッシュトークンは漏洩のリスクが高いのか？
    - リフレッシュトークンは長期間有効なため、漏洩した場合のリスクが高い
- Cookieにトークンを保存する際に設定する「HttpOnly, Secureサイト、SameSite」の設定は具体的にどこで設定を行うのか？
    - rails側で設定することが多い
- フロントエンド側で行うとその時に使うライブラリ(NextAuth), バックエンド側で行う認証(jwtの検証など)、認証にCognitoを使った場合のフローについてのベストプラクティス
    - NextAuthを使ってCognitoとの認証フローを管理する場合、リフレッシュトークンを用いたidトークン・アクセストークンの更新要求もフロント側が担うのか？それともバックエンドが担うのか？
        - 更新要求自体はフロント (NextAuth)がトークンが期限切れになった事を検知して、バックエンドにトークン更新のリクエストをする
    - NextAuthを使ったCognitoとの認証フローとは具体的に何か？ (idトークンを用いたログインのこと？)
        
        ```
        NextAuthを使用したCognitoとの認証フローには、以下のステップが含まれます：
        
        1. ユーザーがログインを開始
        2. NextAuthがCognitoの認証エンドポイントにリダイレクト
        3. ユーザーがCognitoで認証を行う
        4. Cognitoが認証コードを発行し、アプリケーションにリダイレクト
        5. NextAuthが認証コードを使用してIDトークン、アクセストークン、リフレッシュトークンを取得
        6. NextAuthがセッションを作成し、必要な情報を保存
        
        この流れは、OpenID Connect（OIDC）プロトコルに基づいています。
        ```
        

# 次やること

- React TODO リファクタ
- Webセキュリティ
- React インプット

# 感じたこと

- NextAuth, Rails, Cognitoを使った認証フローに関して、ぼんやりとしかわかっておらずある程度整理できたのですっきりしました

# 学習時間

1003h